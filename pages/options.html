<!doctype html>
<html lang="en">
	<head>
		<title>JsonReport Options</title>
		<link type="text/css" rel="stylesheet" href="/lib/css/options.css"/>
		<script type="text/javascript">
			setProperty = function(prop, val) {
				chrome.extension.sendRequest({
					"type": "propSet",
					"prop": prop,
					"val": val
				});
			};

			/*** Init ***/
			chrome.extension.sendRequest({"type": "propGet"}, function(response) {
				for(prop in response) {
					var found = document.getElementById(prop) || document.getElementsByName(prop);
					if(found !== null) {
						if(found instanceof NodeList) {
							var val = response[prop];
							//assume we're setting a radio button
							for(var i = 0; i < found.length; i++) {
								if(found[i].id === val) {
									found[i].checked = true;
									break;
								}
							}
						} else {
							//assume the element is a checkbox
							found.checked = JSON.parse(response[prop]);
						}
					}
				}
			});
		</script>
	</head>
	<body>
		<section>
			<header>
				<h1>Button action</h1>
				<h2>how the browser button behaves</h2>
			</header>
			<ul>
				<li>
					<input type="radio" name="popupAction" id="blank" onclick="setProperty(this.name, this.id)"/>
					<label for="blank">Blank report</label>
				</li>
				<li>
					<input type="radio" name="popupAction" id="url" onclick="setProperty(this.name, this.id)"/>
					<label for="url">Report on current URL</label>
				</li>
				<li>
					<input type="radio" name="popupAction" id="popup" onclick="setProperty(this.name, this.id)"/>
					<label for="popup">Show these options</label>
				</li>
			</ul>
		</section>
		<section>
			<header>
				<h1>Additional Options</h1>
				<h2>coming soon!</h2>
			</header>
			<ul>
				<li>
					<input type="checkbox" id="autoJson" onclick="setProperty(this.id, this.checked)"/>
					<label for="autoJson">Report automatically with URLs ending with .json</label>
				</li>
				<li>
					<input type="checkbox" id="storeHistory" onclick="setProperty(this.id, this.checked)"/>
					<label for="storeHistory">Store report history</label>
				</li>
			</ul>
		</section>
	</body>
</html>